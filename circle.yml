machine:
  services:
    - docker

dependencies:
  pre:
    - pip install awscli --upgrade

test:
  override:
    - mvn clean compile package

deployment:
  development:
    branch: ["cc-ecs"]
    commands:      
      - .deploy/ecs_build.sh DEV $CIRCLE_SHA1
      - .deploy/ecs_deploy.sh terms-service DEV $CIRCLE_SHA1
  production:
    branch: master
    commands:
      - .deploy/dockerhub_push.sh PROD $CIRCLE_SHA1
      - .deploy/ebs_deploy.sh terms-service PROD $CIRCLE_SHA1
